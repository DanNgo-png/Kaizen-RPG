<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Focus Flexible - Kaizen RPG</title>
</head>

<body>
  <div class="flexible-container">
    <!-- Header -->
    <div class="flex-header">
      <h2><i class="fa-solid fa-water"></i> Flow State Timer</h2>

      <div class="header-controls">

        <!-- Ratio Selector -->
        <div class="selector-wrapper">
          <button id="ratio-trigger" class="selector-trigger flexible-focus-timer">
            <div style="display: flex; align-items: center; gap: 8px;">
              <i class="fa-solid fa-scale-balanced"></i>
              <span id="ratio-display">3:1 Standard</span>
            </div>
            <i class="fa-solid fa-chevron-down chevron"></i>
          </button>

          <div id="ratio-menu" class="selector-menu">
            <button class="selector-opt ratio-opt" data-value="2.0" data-label="2:1 Relaxed">
              <span class="opt-bold">2:1</span> Relaxed
            </button>
            <button class="selector-opt ratio-opt selected" data-value="3.0" data-label="3:1 Standard">
              <span class="opt-bold">3:1</span> Standard
            </button>
            <button class="selector-opt ratio-opt" data-value="4.0" data-label="4:1 Industrious">
              <span class="opt-bold">4:1</span> Industrious
            </button>
            <button class="selector-opt ratio-opt" data-value="5.0" data-label="5:1 Hard Mode">
              <span class="opt-bold">5:1</span> Hard Mode
            </button>
            <button class="selector-opt ratio-opt" data-value="6.0" data-label="6:1 Grinding">
              <span class="opt-bold">6:1</span> Grinding
            </button>
          </div>
        </div>

        <!-- Tag Selector -->
        <div class="selector-wrapper">
          <!-- Tag Menu HTML removed; TagUIManager.js will inject it here -->
          <button id="tag-trigger" class="selector-trigger flexible-focus-timer">
            <div style="display: flex; align-items: center; gap: 8px;">
              <i class="fa-solid fa-tag"></i>
              <span id="tag-display">Flexible</span>
            </div>
            <i class="fa-solid fa-chevron-down chevron"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Main Cards -->
    <div class="flex-cards-row">
      <!-- Focus Card -->
      <div id="card-focus" class="flex-card">
        <div class="card-icon"><i class="fa-solid fa-brain"></i></div>
        <div class="card-label">Focus</div>
        <div class="card-time" id="disp-focus">0:00:00</div>
      </div>

      <!-- Balance Card -->
      <div id="card-balance" class="flex-card center-card">
        <div class="card-label">Balance</div>
        <div class="card-time" id="disp-balance">+0:00</div>
        <div class="balance-sub" id="msg-balance">Bank is empty</div>
      </div>

      <!-- Break Card -->
      <div id="card-break" class="flex-card">
        <div class="card-icon"><i class="fa-solid fa-mug-hot"></i></div>
        <div class="card-label">Break</div>
        <div class="card-time" id="disp-break">0:00:00</div>
      </div>
    </div>

    <!-- Controls -->
    <div class="flex-controls">
      <!-- Log Exception -->
      <button id="btn-log-exception" class="btn-flex-icon" title="Log Exception / Manual Adjustment">
        <i class="fa-solid fa-pen-to-square"></i>
      </button>

      <!-- Main Action -->
      <button id="btn-flex-main" class="btn-flex-primary">
        <i class="fa-solid fa-play"></i> Start Focus
      </button>

      <!-- Conclude -->
      <button id="btn-flex-finish" class="btn-flex-secondary hidden">
        <i class="fa-solid fa-flag-checkered"></i> Conclude
      </button>
    </div>

    <div class="session-log">
      <span>Session Started: <span id="session-start-time">--:--</span></span>
    </div>
  </div>

  <!-- ================= MODALS ================= -->
  <!-- Note: Tag Management Modals removed; TagUIManager injects shared modals automatically -->

  <!-- Exception Modal (Mid-Session) -->
  <div id="exception-modal" class="modal-overlay hidden">
    <div class="focus-flexible-modal-content">
      <h3><i class="fa-solid fa-clock-rotate-left"></i> Log Exception</h3>
      <p>Manually adjust current totals. Use negative numbers to remove time.</p>

      <!-- Current Stats Display -->
      <div class="current-stats-row">
        <div class="stat-item">
          <span class="stat-label">Current Focus</span>
          <span class="stat-val" id="exc-display-focus">0:00:00</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Current Break</span>
          <span class="stat-val" id="exc-display-break">0:00:00</span>
        </div>
      </div>

      <div class="input-row">
        <label>Adjust Focus (minutes)</label>
        <input id="exc-focus-input" placeholder="e.g. 10 (add) or -5 (remove)">
      </div>

      <div class="input-row">
        <label>Adjust Break (minutes)</label>
        <input id="exc-break-input" placeholder="e.g. 5 (add) or -2 (remove)">
      </div>

      <div class="modal-actions">
        <button id="btn-exc-cancel" class="btn-flex-secondary">Cancel</button>
        <button id="btn-exc-apply" class="btn-flex-primary">Apply Adjustments</button>
      </div>
    </div>
  </div>

  <!-- Conclusion Modal (End-Session Review) -->
  <div id="conclusion-modal" class="modal-overlay hidden">
    <div class="focus-flexible-modal-content">
      <h3><i class="fa-solid fa-clipboard-check"></i> Session Review</h3>
      <p>Finalize your log. Use the slider to trim excess time.</p>

      <div class="input-row">
        <label>Total Focus (Time)</label>
        <input type="text" id="conclude-focus-input" placeholder="MM:SS">
      </div>

      <div class="input-row">
        <label>Total Break (Time)</label>
        <input type="text" id="conclude-break-input" placeholder="MM:SS">
      </div>

      <div class="modal-actions">
        <button id="btn-conclude-cancel" class="btn-flex-secondary">Cancel</button>
        <button id="btn-conclude-save" class="btn-flex-primary">Save Session</button>
      </div>
    </div>
  </div>

</body>

</html>